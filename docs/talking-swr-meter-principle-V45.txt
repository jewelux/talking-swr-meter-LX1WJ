Talking SWR Meter – ESP32-S3 (Voice Output)
Principle Schematic (ASCII Version, English)
Version 4.5

------------------------------------------------------------
1. HF PATH (Directional Coupler / SWR Bridge)
------------------------------------------------------------

        Transceiver                         Antenna
           │                                   │
           │  TX                                │
           └───────[ RF IN   SWR BRIDGE   RF OUT ]───────────┐
                   60 dB Directional Coupler (SWR Bridge)     │
                   (e.g. 100 W / 2000W models)                │
                          │              │                    │
                          │ FWD          │ REV                │
                          │              │                    │
                          ▼              ▼                    │

                    +----------------------------+
                    |        ESP32-S3            |
                    |      DevKit / Module       |
                    |                            |
     FWD  ─────────►| GPIO1  (ADC1 input)        |
     REV  ─────────►| GPIO2  (ADC1 input)        |
                    |                            |
                    |   (all grounds common)     |
                    +----------------------------+


------------------------------------------------------------
2. AUDIO PATH (I2S → MAX98357A → Speaker)
------------------------------------------------------------

                    +----------------------------+
                    |        ESP32-S3            |
                    |                            |
 I2S BCLK   ───────►| GPIO4                       |
 I2S LRCLK  ───────►| GPIO5                       |
 I2S DIN    ───────►| GPIO6                       |
 AMP_SD     ───────►| GPIO7  (amp enable)        |
                    |                            |
  5V  ◄─────────────| 5V                         |
 GND ───────────────| GND                        |
                    +----------------------------+

        ESP32 I2S                     MAX98357A               Speaker
 (GPIO4/5/6 + GPIO7 enable)  ─────►   Class-D I2S Amp  ────►  4–8 Ω

                   +------------------------+
                   |       MAX98357A        |
                   |                        |
        5V   ◄─────| VIN                    |
       GND   ◄─────| GND                    |
  I2S BCLK  ◄──────| BCLK                   |
  I2S LRCLK ◄──────| LRC                    |
  I2S DIN   ◄──────| DIN                    |
  AMP_SD    ◄──────| SD  (enable pin)       |
                   |                        |
  SPK+ ───────────►| SPK+                   |
  SPK- ───────────►| SPK-                   |
                   +------------------------+


------------------------------------------------------------
3. BUTTON LADDER (6 Buttons on one ADC Pin – GPIO9)
------------------------------------------------------------

Function:
- A 10 kΩ pull-up resistor from 3.3 V to the ADC pin.
- From the same node, six branches go through:
  resistor → switch → ground.
- Each button produces a different voltage at ADC GPIO9.
- Voltage levels are calibrated in the firmware using
  BTN_MID_T1..T6 and BTN_RANGE_T1..T6.

ASCII diagram:

           3.3V
            │
         [Rpull]
         10 kΩ
            │
            ├────────────► ESP32 GPIO9 (ADC)
            │
            │
            ├──[R1  1 kΩ]── S1 ─── GND   (Button T1)
            │
            ├──[R2  2.2 kΩ] S2 ─── GND   (Button T2)
            │
            ├──[R3  4.7 kΩ] S3 ─── GND   (Button T3)
            │
            ├──[R4 10 kΩ]  S4 ─── GND    (Button T4)
            │
            ├──[R5 22 kΩ]  S5 ─── GND    (Button T5)
            │
            └──[R6 47 kΩ]  S6 ─── GND    (Button T6)

Notes:
- Values are examples; actual resistor values depend on your
  hardware and the measured ADC voltages.
- The firmware uses the ladder as a 6-button input system on one pin.


------------------------------------------------------------
4. BUZZER (PWM / LEDC)
------------------------------------------------------------

The buzzer is driven by a PWM output using the ESP32’s LEDC driver.

                    +----------------------------+
                    |         ESP32-S3           |
                    |                            |
     Buzzer S ─────►| GPIO8  (LEDC PWM output)   |
                    |                            |
                    +----------------------------+

        +----------+       +------------------+
        |  ESP32   |       |     Buzzer       |
        |  GPIO8   |──────►| S / SIG          |
        |          |       |                  |
        |   GND    |──────►| –                |
        +----------+  5V ─►| +  (depending on model) |
                           +------------------+

Active buzzer:
– needs PWM and power.

Passive buzzer:
– requires PWM signal to generate tone.


------------------------------------------------------------
5. POWER SUPPLY (13.8 V → Step-Down → 5 V)
------------------------------------------------------------

Typical station power supply (13.8 V):

         13.8 V DC
           +   -
           │   │
           │   └──────────────┐
           │                  │
           ▼                  ▼

      +------------------------------+
      |       Step-Down Module       |
      |         (e.g. LM2596)        |
      |                              |
      |  IN+   ◄────── 13.8 V +      |
      |  IN-   ◄────── GND           |
      |                              |
      |  OUT+  ───────► 5 V +        |
      |  OUT-  ───────► GND          |
      +------------------------------+

5V output distribution:

   OUT+ (5 V)  ─────────► ESP32 5V pin
                               MAX98357 VIN
                               Buzzer + (if 5 V type)
                               any other 5 V peripherals

   OUT- (GND) ─────────► ESP32 GND
                               MAX98357 GND
                               directional coupler GND (if needed)
                               buzzer GND
                               button-ladder GND
                               all grounds must be common


------------------------------------------------------------
6. ESP32-S3 PIN SUMMARY (Sketch V4.5)
------------------------------------------------------------

HF Measurement:
- GPIO1  : FWD ADC input
- GPIO2  : REV ADC input

Button Ladder:
- GPIO9  : ADC input for 6-button ladder (T1..T6)

Audio / I2S:
- GPIO4  : I2S BCLK  → MAX98357 BCLK
- GPIO5  : I2S LRCLK → MAX98357 LRC
- GPIO6  : I2S DOUT  → MAX98357 DIN
- GPIO7  : AMP_SD    → MAX98357 amp enable pin

Buzzer:
- GPIO8  : PWM (LEDC) → buzzer signal pin

Power:
- 5V     : from step-down module
- 3.3V   : on-board regulator (logic)
- GND    : shared ground for all modules


------------------------------------------------------------
End of ASCII schematic (English version)
Talking SWR Meter – ESP32-S3 (Voice Output)
Version 4.5
------------------------------------------------------------
